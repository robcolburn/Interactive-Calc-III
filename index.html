<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Sage Cell Server</title>
    <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
    <script src="http://sagecell.sagemath.org/embedded_sagecell.js"></script>
    <script>
$(function () {
    // Make the div with id 'mycell' a Sage cell
    sagecell.makeSagecell({inputLocation:  '#mycell',
                           template:       sagecell.templates.minimal,
                           evalButtonText: 'Start Example'});
});
    </script>
  </head>
  <body>
  <h1>16.8 #3</h1>

    <div id="mycell"><script type="text/x-sage">

# Here are a few routines we'll write as functions
# To help make it easier to follow later

# This returns us function expression from an equation
def solve_eq_for(f, var_name):
    g = solve(f, var_name, solution_dict = True);
    g = g[0][var_name];
    return g;

# Return the curl of a function f
def curl(f):
    i =  f[2].derivative(y) - f[1].derivative(z)
    j =-(f[2].derivative(x) - f[0].derivative(z))
    k =  f[1].derivative(x) - f[0].derivative(y)
    return vector( [i, j, k] )

# I'm going to use these as variables
# Sage needs to be at least declare them first
x, y, z = var('x,y,z')


# 1. Define the Vector Field and Surface from the Problem
F = vector( [x^2*z, x*y^2, z^2] )
S1 = x + y + z == 1
S2 = x^2 + y^2 == 9
r = vector( [x, y, solve_eq_for(S1, z)] )

# 2. Describe the Surface with a Position Vector
show("F(v)=" + latex(F) + ", r(x,y)=" + latex(r), ", y>=0");

# 3. Plug position vector into vector field
F_of_r = F.subs({x:r[0], y:r[1], z: r[2]});
show("F(r)=" + latex(F_of_r));

# 4. Get curl of F
curled_F = curl(F_of_r)

# 5. Get Normal vector from Crossed partials of position
r_x = derivative(r, x)
r_y = derivative(r, y)
r_prime = r_x.cross_product(r_y);
show('r_x=' + latex(r_x) + ',r_y=' + latex(r_y) + ',(r_x X r_y) =' + latex(r_prime))

#6. Bring this together for the inner
fun = curled_F.dot_product(r_prime)
show("curl F(r) \cdot  (r_x  X r_y) =" + latex(curled_F) + "\cdot" + latex(r_prime) + " = " + latex(fun))


show('\iint\limits_D ' + latex(fun) + 'dA');
show('\int_0^{2p} \! \int_0^1 \! ' + latex(fun) + 'r dr dt');


rad, t = var('rad, t')

fun = fun.subs({x: rad * cos(t), y: rad * sin(t)})
fun = fun * rad

answer = fun.integrate(rad, 0, 3).integrate(t, 0, 2*pi)

show('(a)' + latex(answer))



# Define our interactive
# We'll provide 4 parameters from the user to control
@interact
def _(
    A = slider(-10, 10, 1/2, default = 1),
    B = slider(-10, 10, 1/2, default = 1),
    C = slider(-10, 10, 1/2, default = 1),
    r = slider(1, 10, 1/2, default = 3)
    ):

    K = max(A,B,C)

    plane = A * x + B * y + C * z == K
    cyl = x^2 + y^2 == r^2

    max_x = max(A, r)
    max_y = max(B, r)
    max_z = max(C, r)

    show(plane)
    show(cyl)
    show( (-max_x,max_x) + (-max_y,max_y) + (-max_z,max_z))

    plane = implicit_plot3d(plane,
                        (-max_x,max_x),
                        (-max_y,max_y),
                        (-max_z,max_z),
                        plot_points = 75)
    cyl = implicit_plot3d(cyl,
                        (-max_x,max_x),
                        (-max_y,max_y),
                        (-max_z,max_z),
                        plot_points = 75)

    picture = plane + cyl
    show(picture)


 </script>
</div>

  </body>
</html>
